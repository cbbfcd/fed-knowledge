# 堆区、栈区比较

栈区是由系统自动进行分配空间的，而堆区的空间是由程序员自己通过 `new`、`malloc `等申请的。

栈上的空间是自动分配自动回收的，所以栈上的数据的生存周期只是在函数的运行过程中，运行后就释放掉，不可以再访问。而堆上的需要程序员手动去 `free `或者 `delete`，不然就可能导致内存泄漏。

栈空间的申请效率更高，由系统自动分配，而堆空间的申请效率较之要低效一点，因为要在空闲空间地址的链表上挨个找，找到空间大小满足的之后再从链表中移除该地址，分配给该程序，这一过程就决定了其效率肯定比不上前者了。

栈空间是高地址向低地址拓展的数据结果，是连续的内存，大小是系统定好了的，受限，有溢出的风险。堆空间是向高地址的数据结构，是不连续的，具有更灵活、自由、更大的空间（受限于 计算机系统中有效的虚拟内存）。

到这里为止基本可以解决前边说的 4 个误区，针对第 4 个误区，特地提一下，因为很多文章都直接武断的说 JS 中的基本数据类型（`string, number, bool, null, undefined, symbol`）是分配了栈空间的。

学习堆栈的目的是为了利用其结构特性来增强我们的代码表现，栈空间只需要简单的进行指针的上下移动就可以快速的实现内存的开辟和释放，对于局部变量这种需要快速存储和释放的数据，栈空间存储当然是最好的方式。

但是，JS 的 Closure 是一个神奇的东西，在 Closure 中的局部变量（哪怕是基本类型），因为闭包需要一直持有对其的访问，所以函数调用结束它也不应该被释放，证明它是存在于堆中的。

